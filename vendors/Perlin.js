var PERLIN=PERLIN||Object.create(null);PERLIN.Generator=function(t){this._table=t||PERLIN.Generator.makeTable(255),this.octaves=10,this.frequency=.05,this.persistence=.5},PERLIN.Generator.random=function(){return Math.random()},PERLIN.Generator.makeTable=function(t){for(var e=[],r=0;t>r;++r)e[r]=PERLIN.Generator.random();return e},PERLIN.Generator.cosineInterpolate=function(t,e,r){var n=.5*(1-Math.cos(r*Math.PI));return(1-n)*t+n*e},PERLIN.Generator.prototype={_randify:function(t){return this._table[Math.floor(Math.abs(t)%this._table.length)]},_noise:function(t){for(var e=0,r=t.length,n=0;r>n;++n)e=this._randify(Math.floor(85e3*e)+t[n]);return e},_smooth:function(t,e){if(0>e)return this._noise(t);var r=t[e],n=Math.floor(r),o=r-n;t[e]=n;var a=this._smooth(t,e-1);t[e]=n+1;var i=this._smooth(t,e-1);return t[e]=r,PERLIN.Generator.cosineInterpolate(a,i,o)},_perlin:function(t){for(var e=0,r=1,n=this.octaves,o=this.frequency,a=this.persistence,i=t.slice(),s=i.length,h=0;n>h;++h){for(var f=4096*h,u=0;s>u;++u)i[u]=t[u]*o+f;e+=this._smooth(i,s-1)*r,r*=a,o*=2}var c=(1-a)/(1-r);return e*c},_generate:function(t,e,r,n){if(0>n)return r(t,this._perlin(t));for(var o=t[n]+e[n];o>t[n];++t[n])this._generate(t,e,r,n-1);return t[n]-=e[n],null},generate:function(t,e,r){this._generate(t,e,r,t.length-1)}};